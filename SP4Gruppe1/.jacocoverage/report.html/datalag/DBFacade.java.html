<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="da"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>DBFacade.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;SP4Gruppe1&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">datalag</a> &gt; <span class="el_source">DBFacade.java</span></div><h1>DBFacade.java</h1><pre class="source lang-java linenums">package datalag;

import businesslogic.*;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Time;
import java.sql.Timestamp;
import java.util.ArrayList;

/*
 * @author Caroline, Nina, Rikke og Kristine
 */
public class DBFacade {

    private Connection connection;

<span class="fc" id="L19">    public DBFacade(DBConnection dbc) {</span>
<span class="fc" id="L20">        connection = dbc.getConnection();</span>
<span class="fc" id="L21">    }</span>

    public int getID() {
<span class="fc" id="L24">        int id = 1;</span>
        try {
            //create String for the PreparedStatement
<span class="fc" id="L27">            String selectSQL = &quot;SELECT LAST_INSERT_ID() FROM members&quot;;</span>
            //get connection
<span class="nc" id="L29">            PreparedStatement preparedStatement = connection.prepareStatement(selectSQL);</span>

            //execute the SQL query
<span class="nc" id="L32">            ResultSet result = preparedStatement.executeQuery(selectSQL);</span>
<span class="nc bnc" id="L33" title="All 2 branches missed.">            while (result.next()) {</span>
<span class="nc" id="L34">                id = result.getInt(1);</span>
            }
<span class="fc" id="L36">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L37">        }</span>

<span class="fc" id="L39">        return id;</span>
    }

    public ArrayList&lt;Member&gt; getMembersList() {
<span class="nc" id="L43">        ArrayList&lt;Member&gt; members = new ArrayList&lt;&gt;();</span>
        try {
            //create String for the PreparedStatement
<span class="nc" id="L46">            String selectSQL = &quot;SELECT * FROM members ORDER BY first_name&quot;;</span>
            //get connection
<span class="nc" id="L48">            PreparedStatement preparedStatement = connection.prepareStatement(selectSQL);</span>

            //execute the SQL query
<span class="nc" id="L51">            ResultSet result = preparedStatement.executeQuery(selectSQL);</span>
<span class="nc bnc" id="L52" title="All 2 branches missed.">            while (result.next()) {</span>
<span class="nc" id="L53">                String firstName = result.getString(1);</span>
<span class="nc" id="L54">                String lastName = result.getString(2);</span>
<span class="nc" id="L55">                int age = result.getInt(3);</span>
<span class="nc" id="L56">                boolean isActive = result.getBoolean(4);</span>
<span class="nc" id="L57">                int id = result.getInt(5);</span>
<span class="nc" id="L58">                int contingent = result.getInt(6);</span>
<span class="nc" id="L59">                int restance = result.getInt(7);</span>

                //create a new Member object and insert it into the ArrayList
<span class="nc" id="L62">                members.add(new Member(firstName, lastName, age, isActive, contingent, restance, id));</span>
<span class="nc" id="L63">            }</span>
<span class="nc" id="L64">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L65">        }</span>
<span class="nc" id="L66">        return members;</span>
    }

    public void saveMember(Member member) {
        try {
            //create String for the PreparedStatement
<span class="nc" id="L72">            String insertSQL = &quot;INSERT INTO members &quot;</span>
                    + &quot;(first_name, last_name, age, is_active, &quot;
                    + &quot;contingent, restance) VALUES&quot;
                    + &quot;(?, ?, ?, ?, ?, ?)&quot;;

            //get connection
<span class="nc" id="L78">            PreparedStatement preparedStatement = connection.prepareStatement(insertSQL);</span>
            //insert correct values into the placeholders' (the ?) spaces
<span class="nc" id="L80">            preparedStatement.setString(1, member.getFirstName());</span>
<span class="nc" id="L81">            preparedStatement.setString(2, member.getLastName());</span>
<span class="nc" id="L82">            preparedStatement.setInt(3, member.getAge());</span>
<span class="nc" id="L83">            preparedStatement.setBoolean(4, member.isIsActive());</span>
<span class="nc" id="L84">            preparedStatement.setDouble(5, member.getContingent());</span>
<span class="nc" id="L85">            preparedStatement.setDouble(6, member.getRestance());</span>

            //execute the SQL query
<span class="nc" id="L88">            preparedStatement.executeUpdate();</span>
<span class="nc" id="L89">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L90">        }</span>
<span class="nc" id="L91">    }</span>

    public void deleteMember(int id) {
        try {
<span class="nc" id="L95">            deleteFromCompetition(id);</span>
<span class="nc" id="L96">            deleteFromCompetitiveSwimmers(id);</span>
            //create String for the PreparedStatement
<span class="nc" id="L98">            String deleteSQL = &quot;DELETE FROM members WHERE id = ?&quot;;</span>
            //get connection
<span class="nc" id="L100">            PreparedStatement preparedStatement = connection.prepareStatement(deleteSQL);</span>
            //insert correct values into the placeholder's (the ?) space
<span class="nc" id="L102">            preparedStatement.setInt(1, id);</span>

            //execute the SQL query
<span class="nc" id="L105">            preparedStatement.executeUpdate();</span>
<span class="nc" id="L106">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L107">        }</span>
<span class="nc" id="L108">    }</span>

    private void deleteFromCompetition(int id) {
        try {
            //create String for the PreparedStatement
<span class="nc" id="L113">            String deleteSQL = &quot;DELETE FROM competitions WHERE id = ?&quot;;</span>
            //get connection
<span class="nc" id="L115">            PreparedStatement preparedStatement = connection.prepareStatement(deleteSQL);</span>
            //insert correct values into the placeholder's (the ?) space
<span class="nc" id="L117">            preparedStatement.setInt(1, id);</span>

            //execute the SQL query
<span class="nc" id="L120">            preparedStatement.executeUpdate();</span>
<span class="nc" id="L121">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L122">        }</span>
<span class="nc" id="L123">    }</span>

    private void deleteFromCompetitiveSwimmers(int id) {
        try {
            //create String for the PreparedStatement
<span class="nc" id="L128">            String deleteSQL = &quot;DELETE FROM competitive_swimmers WHERE id = ?&quot;;</span>
            //get connection
<span class="nc" id="L130">            PreparedStatement preparedStatement = connection.prepareStatement(deleteSQL);</span>
            //insert correct values into the placeholder's (the ?) space
<span class="nc" id="L132">            preparedStatement.setInt(1, id);</span>

            //execute the SQL query
<span class="nc" id="L135">            preparedStatement.executeUpdate();</span>
<span class="nc" id="L136">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L137">        }</span>
<span class="nc" id="L138">    }</span>

    public ArrayList&lt;Member&gt; getCompetitiveSwimmersList() {
<span class="nc" id="L141">        ArrayList&lt;Member&gt; swimmers = new ArrayList&lt;&gt;();</span>
        try {
            //create String for the PreparedStatement
<span class="nc" id="L144">            String selectSQL = &quot;SELECT * FROM members&quot;</span>
                    + &quot;NATURAL JOIN competitive_swimmers&quot;;
            //get connection
<span class="nc" id="L147">            PreparedStatement preparedStatement = connection.prepareStatement(selectSQL);</span>

            //execute the SQL query
<span class="nc" id="L150">            ResultSet result = preparedStatement.executeQuery(selectSQL);</span>
<span class="nc bnc" id="L151" title="All 2 branches missed.">            while (result.next()) {</span>
<span class="nc" id="L152">                int id = result.getInt(1);</span>
<span class="nc" id="L153">                String firstName = result.getString(5);</span>
<span class="nc" id="L154">                String lastName = result.getString(6);</span>
<span class="nc" id="L155">                int age = result.getInt(7);</span>
<span class="nc" id="L156">                boolean isActive = result.getBoolean(8);</span>
<span class="nc" id="L157">                int contingent = result.getInt(9);</span>
<span class="nc" id="L158">                int restance = result.getInt(10);</span>

                //create a new Member object and insert it into the ArrayList
<span class="nc" id="L161">                swimmers.add(new Member(firstName, lastName, age, isActive, contingent, restance, id));</span>
<span class="nc" id="L162">            }</span>
<span class="nc" id="L163">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L164">        }</span>
<span class="nc" id="L165">        return swimmers;</span>
    }

    public void saveCompetitiveSwimmer(CompetitiveSwimmer member) {
        try {
<span class="nc" id="L170">            saveMember(member);</span>
            //create String for the PreparedStatement
<span class="nc" id="L172">            String insertSQL = &quot;INSERT INTO competitive_swimmer &quot;</span>
                    + &quot;VALUES (?, ?, ?, ?)&quot;;

            //get connection
<span class="nc" id="L176">            PreparedStatement preparedStatement = connection.prepareStatement(insertSQL);</span>
            //insert correct values into the placeholders' (the ?) spaces
<span class="nc" id="L178">            preparedStatement.setInt(1, member.getId());</span>
<span class="nc" id="L179">            preparedStatement.setString(2, member.getDisciplin());</span>
<span class="nc" id="L180">            preparedStatement.setTime(3, member.getBestTime());</span>
<span class="nc" id="L181">            preparedStatement.setTimestamp(4, member.getDateOfBestTime());</span>

            //execute the SQL query
<span class="nc" id="L184">            preparedStatement.executeUpdate();</span>
<span class="nc" id="L185">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L186">        }</span>
<span class="nc" id="L187">    }</span>

    public ArrayList&lt;CompetitiveSwimmer&gt; getTop5() {
<span class="nc" id="L190">        ArrayList&lt;CompetitiveSwimmer&gt; top5 = new ArrayList&lt;&gt;();</span>
        try {
            //create String for the PreparedStatement
<span class="nc" id="L193">            String selectSQL = &quot;SELECT id, first_name, last_name, age, disciplin, &quot;</span>
                    + &quot;best_time, date_of_best_time FROM members&quot;
                    + &quot;NATURAL JOIN competitive_swimmers ORDER BY best_time&quot;
                    + &quot;LIMIT 5&quot;;
            //get connection
<span class="nc" id="L198">            PreparedStatement preparedStatement = connection.prepareStatement(selectSQL);</span>

            //execute the SQL query
<span class="nc" id="L201">            ResultSet result = preparedStatement.executeQuery(selectSQL);</span>
<span class="nc bnc" id="L202" title="All 2 branches missed.">            while (result.next()) {</span>
<span class="nc" id="L203">                int id = result.getInt(1);</span>
<span class="nc" id="L204">                String firstName = result.getString(2);</span>
<span class="nc" id="L205">                String lastName = result.getString(3);</span>
<span class="nc" id="L206">                int age = result.getInt(4);</span>
<span class="nc" id="L207">                String disciplin = result.getString(5);</span>
<span class="nc" id="L208">                Time bestTime = result.getTime(6);</span>
<span class="nc" id="L209">                Timestamp dateOfBestTime = result.getTimestamp(7);</span>

                //create a new Member object and insert it into the ArrayList
<span class="nc" id="L212">                top5.add(new CompetitiveSwimmer(firstName, lastName, age, id, disciplin,</span>
                        bestTime, dateOfBestTime));
<span class="nc" id="L214">            }</span>
<span class="nc" id="L215">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L216">        }</span>
<span class="nc" id="L217">        return top5;</span>
    }

    public ArrayList&lt;Contingent&gt; getContingentList() {
<span class="nc" id="L221">        ArrayList&lt;Contingent&gt; contingent = new ArrayList&lt;&gt;();</span>
        try {
            //create String for the PreparedStatement
<span class="nc" id="L224">            String selectSQL = &quot;SELECT * FROM contingent&quot;;</span>
            //get connection
<span class="nc" id="L226">            PreparedStatement preparedStatement = connection.prepareStatement(selectSQL);</span>

            //execute the SQL query
<span class="nc" id="L229">            ResultSet result = preparedStatement.executeQuery(selectSQL);</span>
<span class="nc bnc" id="L230" title="All 2 branches missed.">            while (result.next()) {</span>
<span class="nc" id="L231">                int under18 = result.getInt(1);</span>
<span class="nc" id="L232">                int between18And60 = result.getInt(2);</span>
<span class="nc" id="L233">                int over60 = result.getInt(3);</span>
<span class="nc" id="L234">                int passive = result.getInt(4);</span>

                //create a new Member object and insert it into the ArrayList
<span class="nc" id="L237">                contingent.add(new Contingent(under18, between18And60, over60, passive));</span>
<span class="nc" id="L238">            }</span>
<span class="nc" id="L239">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L240">        }</span>
<span class="nc" id="L241">        return contingent;</span>
    }

    public ArrayList&lt;Member&gt; getMembersInRestance() {
<span class="nc" id="L245">        ArrayList&lt;Member&gt; membersInRestance = new ArrayList&lt;&gt;();</span>
        try {
            //create String for the PreparedStatement
<span class="nc" id="L248">            String selectSQL = &quot;SELECT * FROM members  WHERE restance != 0 &quot;</span>
                    + &quot;ORDER BY first_name&quot;;
            //get connection
<span class="nc" id="L251">            PreparedStatement preparedStatement = connection.prepareStatement(selectSQL);</span>

            //execute the SQL query
<span class="nc" id="L254">            ResultSet result = preparedStatement.executeQuery(selectSQL);</span>
<span class="nc bnc" id="L255" title="All 2 branches missed.">            while (result.next()) {</span>
<span class="nc" id="L256">                String firstName = result.getString(1);</span>
<span class="nc" id="L257">                String lastName = result.getString(2);</span>
<span class="nc" id="L258">                int age = result.getInt(3);</span>
<span class="nc" id="L259">                boolean isActive = result.getBoolean(4);</span>
<span class="nc" id="L260">                int id = result.getInt(5);</span>
<span class="nc" id="L261">                int contingent = result.getInt(6);</span>
<span class="nc" id="L262">                int restance = result.getInt(7);</span>

                //create a new Member object and insert it into the ArrayList
<span class="nc" id="L265">                membersInRestance.add(new Member(firstName, lastName, age,</span>
                        isActive, contingent, restance, id));
<span class="nc" id="L267">            }</span>
<span class="nc" id="L268">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L269">        }</span>
<span class="nc" id="L270">        return membersInRestance;</span>
    }

    public ArrayList&lt;CompetitiveSwimmer&gt; getCompetitiveSwimmers() {
<span class="nc" id="L274">        ArrayList&lt;CompetitiveSwimmer&gt; competitiveSwimmers = new ArrayList&lt;&gt;();</span>
        try {
            //create String for the PreparedStatement
<span class="nc" id="L277">            String selectSQL = &quot;SELECT id, first_name, last_name, age, disciplin, &quot;</span>
                    + &quot;best_time, date_of_best_time FROM members&quot;
                    + &quot;NATURAL JOIN competitive_swimmers&quot;;
            //get connection
<span class="nc" id="L281">            PreparedStatement preparedStatement = connection.prepareStatement(selectSQL);</span>

            //execute the SQL query
<span class="nc" id="L284">            ResultSet result = preparedStatement.executeQuery(selectSQL);</span>
<span class="nc bnc" id="L285" title="All 2 branches missed.">            while (result.next()) {</span>
<span class="nc" id="L286">                int id = result.getInt(1);</span>
<span class="nc" id="L287">                String firstName = result.getString(2);</span>
<span class="nc" id="L288">                String lastName = result.getString(3);</span>
<span class="nc" id="L289">                int age = result.getInt(4);</span>
<span class="nc" id="L290">                String disciplin = result.getString(5);</span>
<span class="nc" id="L291">                Time bestTime = result.getTime(6);</span>
<span class="nc" id="L292">                Timestamp dateOfBestTime = result.getTimestamp(7);</span>

                //create a new Member object and insert it into the ArrayList
<span class="nc" id="L295">                competitiveSwimmers.add(new CompetitiveSwimmer(firstName, lastName, age, id, disciplin,</span>
                        bestTime, dateOfBestTime));
<span class="nc" id="L297">            }</span>
<span class="nc" id="L298">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L299">        }</span>
<span class="nc" id="L300">        return competitiveSwimmers;</span>
    }

    public ArrayList&lt;CompetitiveSwimmer&gt; getTrainingsresult() {
<span class="nc" id="L304">        ArrayList&lt;CompetitiveSwimmer&gt; trainingresults = new ArrayList&lt;&gt;();</span>
        try {
            //create String for the PreparedStatement
<span class="nc" id="L307">            String selectSQL = &quot;SELECT id, first_name, last_name, age, disciplin, &quot;</span>
                    + &quot;best_time, date_of_best_time FROM members&quot;
                    + &quot;NATURAL JOIN competitive_swimmers&quot;
                    + &quot;ORDER BY best_time&quot;;
            //get connection
<span class="nc" id="L312">            PreparedStatement preparedStatement = connection.prepareStatement(selectSQL);</span>

            //execute the SQL query
<span class="nc" id="L315">            ResultSet result = preparedStatement.executeQuery(selectSQL);</span>
<span class="nc bnc" id="L316" title="All 2 branches missed.">            while (result.next()) {</span>
<span class="nc" id="L317">                int id = result.getInt(1);</span>
<span class="nc" id="L318">                String firstName = result.getString(2);</span>
<span class="nc" id="L319">                String lastName = result.getString(3);</span>
<span class="nc" id="L320">                int age = result.getInt(4);</span>
<span class="nc" id="L321">                String disciplin = result.getString(5);</span>
<span class="nc" id="L322">                Time bestTime = result.getTime(6);</span>
<span class="nc" id="L323">                Timestamp dateOfBestTime = result.getTimestamp(7);</span>

<span class="nc" id="L325">                trainingresults.add(new CompetitiveSwimmer(firstName, lastName, age, id, disciplin,</span>
                        bestTime, dateOfBestTime));
<span class="nc" id="L327">            }</span>
<span class="nc" id="L328">        } catch (SQLException | NullPointerException e) {</span>
<span class="nc" id="L329">        }</span>
<span class="nc" id="L330">        return trainingresults;</span>
    }

    public int editUnder18(int contingent) {
        try {
<span class="nc" id="L335">            String UpdateSQL = &quot;UPDATE contingent SET under_18 = ?&quot;;</span>
<span class="nc" id="L336">            PreparedStatement preparedStatement = connection.prepareStatement(UpdateSQL);</span>
<span class="nc" id="L337">            preparedStatement.setInt(1, contingent);</span>

<span class="nc" id="L339">        } catch (SQLException e) {</span>
<span class="nc" id="L340">        }</span>
<span class="nc" id="L341">        return contingent;</span>

    }

    public int editBetween18And60(int contingent) {
        try {
<span class="nc" id="L347">            String UpdateSQL = &quot;UPDATE contingent SET between_18_and_60 = ?&quot;;</span>
<span class="nc" id="L348">            PreparedStatement preparedStatement = connection.prepareStatement(UpdateSQL);</span>
<span class="nc" id="L349">            preparedStatement.setInt(1, contingent);</span>

<span class="nc" id="L351">        } catch (SQLException e) {</span>
<span class="nc" id="L352">        }</span>
<span class="nc" id="L353">        return contingent;</span>
    }

    public int editOver60(int contingent) {
        try {
<span class="nc" id="L358">            String UpdateSQL = &quot;UPDATE contingent SET over_60 = ?&quot;;</span>
<span class="nc" id="L359">            PreparedStatement preparedStatement = connection.prepareStatement(UpdateSQL);</span>
<span class="nc" id="L360">            preparedStatement.setInt(1, contingent);</span>

<span class="nc" id="L362">        } catch (SQLException e) {</span>
<span class="nc" id="L363">        }</span>
<span class="nc" id="L364">        return contingent;</span>
    }

    public int editPassive(int contingent) {
        try {
<span class="nc" id="L369">            String UpdateSQL = &quot;UPDATE contingent SET passive = ?&quot;;</span>
<span class="nc" id="L370">            PreparedStatement preparedStatement = connection.prepareStatement(UpdateSQL);</span>
<span class="nc" id="L371">            preparedStatement.setInt(1, contingent);</span>
<span class="nc" id="L372">            preparedStatement.executeUpdate();</span>

<span class="nc" id="L374">        } catch (SQLException e) {</span>
<span class="nc" id="L375">        }</span>
<span class="nc" id="L376">        return contingent;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>